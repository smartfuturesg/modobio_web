import os
import sys
sys.path.insert(0, os.path.abspath('../src'))

from setuptools_scm import get_version

def plain_version(version):
    return 'version: {}'.format(version.tag)

version = get_version(
    root='..',
    relative_to=__file__,
    version_scheme=plain_version,
    local_scheme='no-local-version'
)
release = version

project = 'Odyssey'
author = 'AVP developers'

with open('../LICENSE.md') as fh:
    copyright = fh.read().strip()

extensions = [
    # numpydoc syntax
    'sphinx.ext.napoleon',
    # links to other projects
    'sphinx.ext.intersphinx'
]

# Don't use the following files that get generated by apidoc.
exclude_patterns = [
    'odyssey/modules.rst',
    'odyssey/odyssey.api.client_services.rst',
    'odyssey/odyssey.api.client.rst',
    'odyssey/odyssey.api.doctor.rst',
    'odyssey/odyssey.api.facility.rst',
    'odyssey/odyssey.api.lookup.rst',
    'odyssey/odyssey.api.misc.rst',
    'odyssey/odyssey.api.notifications.rst',
    'odyssey/odyssey.api.physiotherapy.rst',
    'odyssey/odyssey.api.staff.rst',
    'odyssey/odyssey.api.system.rst',
    'odyssey/odyssey.api.telehealth.rst',
    'odyssey/odyssey.api.trainer.rst',
    'odyssey/odyssey.api.user.rst',
    'odyssey/odyssey.api.version.rst',
    'odyssey/odyssey.api.wearables.rst',
    'odyssey/odyssey.rst',
    'odyssey/odyssey.run.rst',
    '_build',
    'Thumbs.db',
    '.DS_Store'
]

html_theme = 'sphinx_rtd_theme'
html_static_path = ['_static']
html_style = 'css/custom.css'

napoleon_use_ivar = True
napoleon_use_rtype = False
napoleon_custom_sections = ['Glossary']

autodoc_default_options = {
    'no-undoc-members': True,
    'member-order': 'bysource'
}

intersphinx_mapping = {
    'flask': ('https://flask.palletsprojects.com/', None),
    'flask_migrate': ('https://flask-migrate.readthedocs.io/en/latest/', None),
    'flask_sqlalchemy': ('https://flask-sqlalchemy.palletsprojects.com/', None),
    'flask_wtf': ('https://flask-wtf.readthedocs.io/en/stable/', None),
    'python': ('https://docs.python.org/3/', None),
    'sqlalchemy': ('https://docs.sqlalchemy.org/', None),
    'werkzeug': ('https://werkzeug.palletsprojects.com/', None),
    'whoosh': ('https://whoosh.readthedocs.io/en/latest/', None),
    'wtforms': ('https://wtforms.readthedocs.io/', None)
}
